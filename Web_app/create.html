<!DOCTYPE html>
<html>
<head>
    <title>Page</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/jquery-ui.css">
    <link rel="stylesheet" href="assets/css/mdb.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <link rel="stylesheet" href="assets/css/swal.css">
    <script src="assets/js/swal.js"></script>
    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/script.js"></script>
    <script src="assets/js/const_settings.js"></script>
    <script src="assets/js/jquery-ui.js"></script>
    <script src="assets/js/searchEngine.js"></script>
    <script src="assets/js/login_handle.js"></script>
    <script src="assets/js/create_script.js"></script>
    <script src="assets/js/jsSHA.js"></script>
<!--    <script>-->
<!--        setTimeout(function() {window.location.reload(true);}, 1000);-->
<!--    </script>-->
</head>
<body>
<div class="sticky-top"><nav></nav></div>
<!-- Tabs navs -->
<ul class="nav nav-tabs nav-justified mb-3" id="tab" role="tablist">
    <li class="nav-item" role="presentation">
        <a class="nav-link active" id="tab-request" data-mdb-toggle="tab" href="#tabs-request" role="tab" aria-controls="tabs-request" aria-selected="true">Zlecenie</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link" id="tab-customer" data-mdb-toggle="tab" href="#tabs-customer" role="tab" aria-controls="tabs-customer" aria-selected="false">Klient</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link" id="tab-employee" data-mdb-toggle="tab" href="#tabs-employee" role="tab" aria-controls="tabs-employee" aria-selected="false">Pracownik</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link" id="tab-department" data-mdb-toggle="tab" href="#tabs-department" role="tab" aria-controls="tabs-department" aria-selected="false">Dział</a>
    </li>
</ul>
<!-- Tabs navs -->

<div class="d-flex justify-content-center align-content-center">
    <!-- Tabs content -->
    <div class="tab-content" id="tabs-content">
        <div class="tab-pane fade show active" id="tabs-request" role="tabpanel" aria-labelledby="tab-request">
            <form>
                <!-- dataset input -->
                <div class="form-outline mb-4">
                    <input id="request_customer" name="id_customer" class="form-control" list="request_customers" onchange="update_field('request_customers', 'request_customer-value', this)">
                    <datalist id="request_customers">
                    </datalist>
                    <label class="form-label" for="request_customer">Wybierz klienta</label>
                </div>
                <div class="form-outline mb-4">
                    <input type="text" id="request_customer-value" class="form-control" disabled/>
                    <label class="form-label" for="request_customer-value"></label>
                </div>

                <!-- dataset input -->
                <div class="form-outline mb-4">
                    <input id="request_employee" name="id_employee" class="form-control" list="request_employees" onchange="update_field('request_employees', 'request_employee-value', this)">
                    <datalist id="request_employees">
                    </datalist>
                    <label class="form-label" for="request_employee">Wybierz pracownika</label>
                </div>
                <div class="form-outline mb-4">
                    <input type="text" maxlength="100" id="request_employee-value" class="form-control" disabled/>
                    <label class="form-label" for="request_employee-value"></label>
                </div>

                <!-- text input -->
                <div class="form-outline mb-4">
                    <input type="text" maxlength="100" id="request_item" name="item" class="form-control" />
                    <label class="form-label" for="request_item">Nazwa/model</label>
                </div>

                <!-- Message input -->
                <div class="form-outline mb-4">
                    <textarea maxlength="300" class="form-control" id="request_description" name="description" rows="4"></textarea>
                    <label class="form-label" for="request_description">Opis</label>
                </div>
                <div class="mb-4">
                    (Uwzględnij wszystkie informacja, tj: wyposażenie, problem, czy numer dowodu zakupu)
                </div>

                <!-- Submit button -->
                <button type="button" class="btn btn-primary btn-block mb-4" id="request_apply" onclick="new_data(this.form, 'request')">Wyślij</button>
            </form>
        </div>
        <div class="tab-pane fade" id="tabs-customer" role="tabpanel" aria-labelledby="tab-customer">
            <form id="customer_form">


                <div class="form-outline mb-4">
                    <input type="text" id="customer_name" name="name" class="form-control" />
                    <label class="form-label" for="customer_name">Imię</label>
                </div>

                <!-- email input -->
                <div class="form-outline mb-4">
                    <input type="email" id="customer_email" name="email" class="form-control" />
                    <label class="form-label" for="customer_email">Email</label>
                </div>

                <!-- text input -->
                <div class="form-outline mb-4">
                    <input type="text" id="customer_phone" name="phone_number" class="form-control" />
                    <label class="form-label" for="customer_phone">Numer telefonu</label>
                </div>

                <!-- Submit button -->
                <button type="button" class="btn btn-primary btn-block mb-4" id="customer_apply" onclick="new_data(this.form, 'customer')">Wyślij</button>
            </form>
        </div>
        <div class="tab-pane fade" id="tabs-employee" role="tabpanel" aria-labelledby="tab-employee">
            <form>
                <div class="row mb-4">
                    <div class="col">
                        <div class="form-outline">
                            <input type="text" id="employee_username" name="username" class="form-control" />
                            <label class="form-label" for="employee_username">Nazwa użytkownika</label>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-outline">
                            <input type="password" id="employee_pasword" name="password" class="form-control" />
                            <label class="form-label" for="employee_pasword">Hasło</label>
                        </div>
                    </div>
                </div>

                <!-- text input -->
                <div class="form-outline mb-4">
                    <input type="email" id="employee_name" name="name" class="form-control" />
                    <label class="form-label" for="employee_name">Imię i nazwisko</label>
                </div>

                <!-- text input -->
                <div class="form-outline mb-4">
                    <input type="email" id="employee_email" name="email" class="form-control" />
                    <label class="form-label" for="employee_email">Email</label>
                </div>

                <!-- text input -->
                <div class="form-outline mb-4">
                    <input type="text" id="employee_phone" name="phone_number" class="form-control" />
                    <label class="form-label" for="employee_phone">Numer telefonu</label>
                </div>

                <!-- select input -->
                <select id="employee_department" name="department_id" class="form-select mb-4" aria-label="Default select example">
                    <option selected disabled>Wybierz dział</option>
                </select>

                <!-- Checked checkbox -->
                <div class="form-check mb-4">
                    <input class="form-check-input" type="checkbox" value="" id="employee_activated" name="activated" checked/>
                    <label class="form-check-label" for="employee_activated">Konto ma być aktywne?</label>
                </div>

                <!-- Submit button -->
                <button type="button" class="btn btn-primary btn-block mb-4" id="employee_apply" onclick="new_data(this.form, 'employee')">Wyślij</button>
            </form>
        </div>
        <div class="tab-pane fade" id="tabs-department" role="tabpanel" aria-labelledby="tab-department">
            <form>

                <!-- text input -->
                <div class="form-outline mb-4">
                    <input type="email" id="department_name" name="name" class="form-control" />
                    <label class="form-label" for="department_name">Nazwa</label>
                </div>

                <!-- Submit button -->
                <button type="button" class="btn btn-primary btn-block mb-4" id="department_apply" onclick="new_data(this.form, 'department')">Wyślij</button>
            </form>
        </div>
    </div>
    <!-- Tabs content -->
</div>
<div id="dialog_parent"></div>
<script>
    let message = getCookie('message');
    if (message !== '') {
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 5000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
            }
        })

        Toast.fire({
            icon: message.split(':')[0],
            title: message.split(':')[1]
        })
        setCookie('message', '');
    }
    checkToken();
    let token = getCookie('authorization');
    fetch('http://127.0.0.1:20001/get/customers', {method: "GET", mode: "cors", headers: {'authorization': token}})
        .then((resp) => resp.json())
        .then(function(data) {
            data.forEach(element => {
                $('#request_customers').append(`<option value="${element['id']}">${element['name']} - ${element['phone_number']}</option>`);
            });
        });
    fetch('http://127.0.0.1:20001/get/employees', {method: "GET", mode: "cors", headers: {'authorization': token}})
        .then((resp) => resp.json())
        .then(function(data) {
            data.forEach(element => {
                $('#request_employees').append(`<option value="${element['id']}">${element['name']} - ${element['department']}</option>`);
            });
        });
    fetch('http://127.0.0.1:20001/get/departments', {method: "GET", mode: "cors", headers: {'authorization': token}})
        .then((resp) => resp.json())
        .then(function(data) {
            data.forEach(element => {
                $('#employee_department').append(`<option value="${element['id']}">${element['name']}</option>`);
            });
        });
</script>
<script src="assets/js/mdb.min.js"></script>
</body>
</html>
